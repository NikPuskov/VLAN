# VLAN

--------------------------------------------------------------------------------------------------

Цель домашнего задания:

- Научиться настраивать VLAN и LACP.

--------------------------------------------------------------------------------------------------

Описание домашнего задания:

1) В Office1 в тестовой internal сети есть сервера с доп интерфейсами и адресами:

- testClient1 - 10.10.10.254

- testClient2 - 10.10.10.254

- testServer1 - 10.10.10.1

- testServer2 - 10.10.10.1

2) Развести вланами: testClient1 <-> testServer1 testClient2 <-> testServer2

3) Между centralRouter и inetRouter "пробросить" 2 линка (общая inernal сеть) и объединить их в бонд, проверить работу c отключением интерфейсов

------------------------------------------------------------------------------------------------------

По итогу выполнения домашнего задания у нас должна получиться следующая топология сети:

![Image alt](https://github.com/NikPuskov/VLAN/blob/main/image.png)

------------------------------------------------------------------------------------------------------

Описание выполнения домашнего задания:

1) Устанавливаем дополнительные пакеты `vim` `traceroute` `tcpdump` `net-tools`

2) Настраиваем VLAN на хостах.

- На RHEL-based системах (на примере хоста testClient1). Создаём файл /etc/sysconfig/network-scripts/ifcfg-vlan1 со следующим параметрами:

image1

- На хосте testServer1 создаем идентичный файл с другим IP-адресом (10.10.10.1)

- Перезапускаем сеть:

`systemctl restart NetworkManager`

- Проверяем корректность настройки:

`ip a`

`ping 10.10.10.254`

- Настройка VLAN на Ubuntu (на примере testClient2 ) Требуется создать файл /etc/netplan/50-cloud-init.yaml со следующим параметрами:

image2

- На хосте testServer2 создаём идентичный файл с другим IP-адресом (10.10.10.1)

- После создания файлов нужно перезапустить сеть на обоих хостах:

`netplan apply`

- После настройки второго VLAN`а ping должен работать между хостами testClient1, testServer1 и между хостами testClient2, testServer2

3) Настройка LACP между хостами inetRouter и centralRouter.

- Необходимо на обоих хостах добавить конфигурационные файлы для интерфейсов eth1 и eth2:

`vim /etc/sysconfig/network-scripts/ifcfg-eth1`

image3

- У интерфейса ifcfg-eth2 идентичный конфигурационный файл, в котором нужно изменить имя интерфейса

- После настройки интерфейсов eth1 и eth2 нужно настроить bond-интерфейс, для этого создадим файл /etc/sysconfig/network-scripts/ifcfg-bond0:

image4

- После создания данных конфигурационных файлов необходимо перезапустить сеть:

`systemctl restart NetworkManager`

- На некоторых версиях RHEL/CentOS перезапуск сетевого интерфейса не запустит bond-интерфейс, в этом случае рекомендуется перезапустить хост

- После настройки агрегации портов, необходимо проверить работу bond-интерфейса, для этого, на хосте inetRouter (192.168.255.1) запустим ping до centralRouter (192.168.255.2):

`ping 192.168.255.2`

Не отменяя ping подключаемся к хосту centralRouter и выключаем там интерфейс eth1:

`ip link set down eth1`

После данного действия ping не должен пропасть, так как трафик пойдёт по-другому порту.
